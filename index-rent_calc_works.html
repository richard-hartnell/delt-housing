<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DELT Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }

        .slider-container {
            margin: 20px;
        }

        .slider-label {
            font-size: 18px;
        }

        .output {
            font-size: 24px;
            font-weight: bold;
            margin: 10px;
        }

        .radio-container {
            margin: 20px;
        }

        .radio-label {
            font-size: 18px;
        }

        .results-container {
            display: flex;
            justify-content: space-between;
        }

        .tenant-section {
            display: flex;
            align-items: center;
            margin: 20px;
        }

        .tenant-slider {
            flex: 1;
        }

        .tenant-info {
            flex: 1;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="slider-container">
        <label class="slider-label">DELTflation:</label>
        <input type="range" id="DELTflation" min="1.03" max="1.07" step="0.002" value="1.03" class="slider">
        <span id="DELTflationValue">1.03</span>
    </div>

    <div class="slider-container">
        <label class="slider-label">Dissolve Length:</label>
        <input type="range" id="dissolveLength" min="10" max="60" value="20" class="slider">
        <span id="dissolveLengthValue">20</span>
    </div>

    <div class="slider-container">
        <label class="slider-label">Mortgage Length:</label>
        <input type="range" id="mortgageLength" min="10" max="40" value="20" class="slider">
        <span id="mortgageLengthValue">20 years</span>
    </div>

    <div class="slider-container">
        <label class="slider-label">Home Price:</label>
        <input type="range" id="homePrice" min="100000" max="4000000" value="400000" class="slider">
        <span id="homePriceValue">$400,000</span>
    </div>

    <div class="slider-container">
        <label class="slider-label"># of Residents:</label>
        <input type="range" id="housemates" min="1" max="20" value="5" class="slider">
        <span id="housematesValue">5</span>
    </div>

    <div class="slider-container">
        <label class="slider-label">Year:</label>
        <input type="range" id="year" min="1" max="100" value="1" class="slider">
        <span id="yearValue">50</span>
    </div>

    <div class="first-month-rent">
        First Month Rent: $<span id="firstMonthRentValue">0</span>
    </div>

    <div class="tenant-section">
        <div class="tenant-slider">
            <label class="slider-label">Tenant's Year:</label>
            <input type="range" id="tenantYear" min="1" max="100" value="1" class="slider" step="1">
        </div>
        <div class="tenant-info">
            <p>I moved in during year <span id="tenantStartYear">X</span> of the DELT and lived there <span id="tenantYears">Y</span> years.</p>
            <p>I paid <span id="tenantPaid">P</span> into the equity of the trust and received <span id="tenantReceived">Q</span> back over <span id="tenantReceivedYears">Z</span> years.</p>
            <p>When I moved in, rent was <span id="tenantStartRent">A%</span> of market rate.</p>
            <p>When I moved out, rent was <span id="tenantEndRent">B%</span> of market rate!</p>
            <p>I saved <span id="tenantRentSavings">C%</span> on my rent compared to a market-rate tenant, roughly <span id="tenantIncomeSavings">D%</span> of my income.</p>
        </div>
    </div>

    <div class="results-container">
        <div class="result-column">
            <label class="result-label">Result 1:</label>
            <div id="result1" class="output">-</div>
            <label class="result-label">Result 2:</label>
            <div id="result2" class="output">-</div>
            <label class="result-label">Result 3:</label>
            <div id="result3" class="output">-</div>
            <label class="result-label">Result 4:</label>
            <div id="result4" class="output">-</div>
            <label class="result-label">Result 5:</label>
            <div id="result5" class="output">-</div>
            <!-- Display DELTindex below Result 5 in the left column -->
            <label class="result-label">DELTindex:</label>
            <div id="DELTindex" class="output">-</div>
        </div>
        <div class="result-column">
            <label class="result-label">Result 1:</label>
            <div id="result6" class="output">-</div>
            <label class="result-label">Result 2:</label>
            <div id="result7" class="output">-</div>
            <label class="result-label">Result 3:</label>
            <div id="result8" class="output">-</div>
            <label class="result-label">Result 4:</label>
            <div id="result9" class="output">-</div>
            <label class="result-label">Result 5:</label>
            <div id="result10" class="output">-</div>
            <!-- Display MRindex below Result 5 in the right column -->
            <label class="result-label">MRindex:</label>
            <div id="MRindex" class="output">-</div>
        </div>
    </div>

    <script>
        const DELTflationSlider = document.getElementById('DELTflation');
        const DELTflationValue = document.getElementById('DELTflationValue');
        const dissolveLength = document.getElementById('dissolveLength');
        const dissolveLengthValue = document.getElementById('dissolveLengthValue');
        const mortgageLength = document.getElementById('mortgageLength');
        const mortgageLengthValue = document.getElementById('mortgageLengthValue');
        const homePrice = document.getElementById('homePrice');
        const output1 = document.getElementById('output1');
        const homePriceValue = document.getElementById('homePriceValue');
        const housemates = document.getElementById('housemates');
        const output2 = document.getElementById('output2');
        const housematesValue = document.getElementById('housematesValue');
        const year = document.getElementById('year');
        const yearValue = document.getElementById('yearValue');
        const yearOutput = document.getElementById('yearOutput');
        const firstMonthRentValue = document.getElementById('firstMonthRentValue');
        const tenantYear = document.getElementById('tenantYear');
        const tenantStartYear = document.getElementById('tenantStartYear');
        const tenantYears = document.getElementById('tenantYears');
        const tenantPaid = document.getElementById('tenantPaid');
        const tenantReceived = document.getElementById('tenantReceived');
        const tenantReceivedYears = document.getElementById('tenantReceivedYears');
        const tenantStartRent = document.getElementById('tenantStartRent');
        const tenantEndRent = document.getElementById('tenantEndRent');
        const tenantRentSavings = document.getElementById('tenantRentSavings');
        const tenantIncomeSavings = document.getElementById('tenantIncomeSavings');
        const inflation = 1.03;

        // Calculate DELTindex based on conditions
        const DELTindex = {};
        const updateDELTindex = () => {
            const DELTflation = parseFloat(DELTflationSlider.value);
            const dInf = (inflation - DELTflation) / parseInt(dissolveLengthValue.textContent);
            for (let i = 1; i <= 100; i++) {
                if (i <= parseInt(mortgageLengthValue.textContent)) {
                    DELTindex[i] = Math.round(parseInt(firstMonthRentValue.textContent) * Math.pow(DELTflation, i));
                } else if (i <= parseInt(mortgageLengthValue.textContent) + parseInt(dissolveLengthValue.textContent)) {
                    DELTindex[i] = Math.round(DELTindex[i - 1] * (DELTflation - (dInf * (i - parseInt(mortgageLengthValue.textContent)))));
                } else {
                    DELTindex[i] = Math.round(DELTindex[i - 1] * inflation);
                }
            }
            // Update the displayed DELTindex value
            document.getElementById('DELTindex').textContent = DELTindex[parseInt(yearValue.textContent)];
        };

        // Calculate MRindex based on conditions
        const MRindex = {};
        const updateMRindex = () => {
            const MRflation = 1.072;
            for (let i = 1; i <= 100; i++) {
                MRindex[i] = Math.round(firstMonthRentValue.textContent * (Math.pow(MRflation, i)));
            }
            document.getElementById('MRindex').textContent = MRindex[parseInt(yearValue.textContent)];
        };

        // Function to update "First Month Rent"
        const updateFirstMonthRent = () => {
            const priceAfterInterest = parseInt(homePrice.value) * 1.7;
            const mortgageLengthValue = parseInt(mortgageLength.value);
            const housemateSliderValue = parseInt(housemates.value);
            const firstMonthRent = Math.floor(priceAfterInterest * 2 / mortgageLengthValue / 12 / housemateSliderValue);
            firstMonthRentValue.textContent = firstMonthRent;
            updateDELTindex();
            updateMRindex();
        };

        // Function to simulate a tenant
        const simulateTenant = () => {
            const tenantYearValue = parseInt(tenantYear.value);
            tenantStartYear.textContent = tenantYearValue;
            tenantYears.textContent = tenantYearValue - parseInt(yearValue.textContent);
            const rentSavings = ((parseInt(tenantStartRent.textContent) - parseInt(tenantEndRent.textContent)) / parseInt(tenantStartRent.textContent)) * 100;
            tenantPaid.textContent = DELTindex[tenantYearValue] - DELTindex[parseInt(yearValue.textContent)];
            tenantReceived.textContent = MRindex[parseInt(yearValue.textContent) + parseInt(tenantReceivedYears.textContent)] - MRindex[parseInt(yearValue.textContent)];
            tenantRentSavings.textContent = rentSavings.toFixed(2) + "%";
            tenantIncomeSavings.textContent = (rentSavings * 0.01 * parseInt(tenantStartRent.textContent)).toFixed(2) + "%";
        };

        // Event listeners for sliders
        const slidersToUpdateFirstMonthRent = [homePrice, housemates, mortgageLength];

        slidersToUpdateFirstMonthRent.forEach(slider => {
            slider.addEventListener('input', () => {
                updateFirstMonthRent();
            });
        });

        DELTflationSlider.addEventListener('input', () => {
            const value = parseFloat(DELTflationSlider.value).toFixed(3);
            DELTflationValue.textContent = value;
            updateDELTindex();
        });

        dissolveLength.addEventListener('input', () => {
            const value = parseInt(dissolveLength.value);
            dissolveLengthValue.textContent = value;
            updateDELTindex();
        });

        mortgageLength.addEventListener('input', () => {
            const value = parseInt(mortgageLength.value);
            mortgageLengthValue.textContent = value + ' years';
            updateFirstMonthRent();
        });

        homePrice.addEventListener('input', () => {
            const value = parseInt(homePrice.value);
            homePriceValue.textContent = '$' + value;
            updateFirstMonthRent();
        });

        housemates.addEventListener('input', () => {
            const value = parseInt(housemates.value);
            housematesValue.textContent = value;
            updateFirstMonthRent();
        });

        year.addEventListener('input', () => {
            const value = parseInt(year.value);
            yearValue.textContent = value;
            updateDELTindex();
            updateMRindex();
            simulateTenant(); // Update tenant info when the year changes
        });

        tenantYear.addEventListener('input', () => {
            simulateTenant(); // Update tenant info when the tenant year changes
        });

        // Initial calculation and display of DELTindex and firstMonthRentValue
        updateFirstMonthRent();
        updateDELTindex();
        updateMRindex();
        simulateTenant(); // Initialize tenant info
    </script>
</body>
</html>
